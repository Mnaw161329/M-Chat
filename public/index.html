<!doctype html>
<html lang="en" style="user-select: none;">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>JSON Chat</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="style.css">
  <style>
    :root { --bg:#0f172a; --panel:#111827; --muted:#94a3b8; --text:#e5e7eb; --accent:#22d3ee; --accent2:#60a5fa; }
    * { box-sizing: border-box; }
    body { margin:0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; background: linear-gradient(120deg, #0f172a, #0b1023); color: var(--text); }
    header { padding:16px 20px; display:flex; gap:12px; align-items:center; border-bottom:1px solid #1f2937; background: rgba(17,24,39,.6); backdrop-filter: blur(6px); position:sticky; top:0; z-index:10; }
    header h1 { font-size:18px; margin:0; letter-spacing:.5px; }
    header .status { margin-left:auto; font-size:12px; color: var(--muted); }
    main { display:grid; grid-template-columns: 280px 1fr; gap:16px; padding:16px; height: calc(100vh - 96px); }
    .sidebar { background: rgba(17,24,39,.6); border:1px solid #1f2937; border-radius:12px; padding:8px; display:flex; flex-direction:column; gap:8px; width:280px; flex-shrink:0; }
    .room-list { display:flex; flex-direction:column; gap:6px; overflow:auto; }
    .room { padding:10px 12px; border-radius:10px; border:1px solid #1f2937; cursor:pointer; color:#cbd5e1; background:#0b1220; }
    .room.active { background: linear-gradient(120deg, rgba(34,211,238,.15), rgba(96,165,250,.15)); border-color:#334155; color:#e5e7eb; }
    .room-form { display:flex; gap:8px; }
    .room-form input { flex:1; padding:10px 12px; border-radius:10px; border:1px solid #1f2937; background:#0b1220; color:#e5e7eb; }
    .room-form button { padding:10px 12px; border-radius:10px; border:1px solid #334155; background: linear-gradient(120deg, var(--accent), var(--accent2)); color:#081019; font-weight:600; cursor:pointer;}

    .chat { display:grid; grid-template-rows: 56px 1fr 48px; gap:20px; height: calc(100vh - 96px); align-items: stretch; justify-items: stretch; }
    .topbar { background: rgba(75, 80, 90, 0.6); border:1px solid #1f2937; border-radius:12px; display:flex; align-items:center; padding:0 14px; }
    .topbar input { margin-left: auto; padding:8px 10px; border-radius:8px; border:1px solid #1f2937; background:#0b1220; color:#e5e7eb; }

    .messages { background: rgba(17,24,39,.6); border:1px solid #1f2937; border-radius:12px; padding:12px; overflow:auto; display:flex; flex-direction:column; gap:8px; }
    .msg { max-width:70%; padding:10px 12px; border-radius:12px; border:1px solid #1f2937; background:#0b1220; box-shadow: 0 0 0 1px rgba(255,255,255,.02) inset; }
    .msg.me { margin-left:auto; background: linear-gradient(120deg, rgba(34,211,238,.2), rgba(96,165,250,.2)); }
    .msg .meta { font-size:11px; color:#94a3b8; margin-bottom:4px; }
    .msg .text { white-space: pre-wrap; word-wrap: break-word; }
    .sys { align-self:center; font-size:12px; color:#94a3b8; padding:6px 10px; background:rgba(15,23,42,.6); border:1px dashed #334155; border-radius:999px; margin:6px 0; }

    .composer { display:flex; gap:10px; align-items: center; padding: 0; margin: 0; height: 48px; }
    .composer input { flex:1; padding:20px 24px; border-radius:12px; border:1px solid #1f2937; background:#0b1220; color:#e5e7eb; height:36px; font-size:14px; line-height:36px; text-align:left; margin-bottom:0; }
    .composer button { padding:20px 24px; border-radius:12px; border:1px solid #334155; background: linear-gradient(120deg, var(--accent), var(--accent2)); color:#081019; font-weight:700; cursor:pointer; height:36px; font-size:14px; line-height:36px; text-align:center; display:flex; align-items:center; justify-content:center; margin-bottom:0; }

    .auth-container { max-width:400px; margin:100px auto; padding:40px; background: rgba(17,24,39,.8); border:1px solid #1f2937; border-radius:16px; backdrop-filter: blur(8px); }
    .auth-form { display:flex; flex-direction:column; gap:16px; }
    .auth-form h2 { margin:0 0 24px 0; text-align:center; color:#e5e7eb; }
    .auth-form input { padding:12px 16px; border-radius:12px; border:1px solid #1f2937; background:#0b1220; color:#e5e7eb; font-size:14px; }
    .auth-form input:focus { outline:none; border-color:#22d3ee; box-shadow:0 0 0 2px rgba(34,211,238,.2); }
    .auth-form button { padding:12px 16px; border-radius:12px; border:1px solid #334155; background: linear-gradient(120deg, var(--accent), var(--accent2)); color:#081019; font-weight:600; cursor:pointer; margin-top:8px; }
    .auth-form .error { color:#ef4444; font-size:12px; margin-top:4px; }
    .auth-form .link { color:#22d3ee; cursor:pointer; text-decoration:none; font-size:14px; text-align:center; margin-top:16px; }
    .auth-form .link:hover { text-decoration:underline; }
    .logout-btn { padding:6px 12px; border-radius:8px; border:1px solid #334155; background: rgba(239,68,68,.2); color:#fca5a5; font-size:12px; cursor:pointer; margin-left:12px; }
    .logout-btn:hover { background: rgba(239,68,68,.3); }
    .hidden { display: none !important; }

    /* Password toggle styles */
    .password-container { position: relative; display: inline-block; width: 100%; }
    .password-container input { padding-right: 16px; width: 100%; }
  </style>
</head>
<body>
  <!-- Authentication Container -->
  <div id="authContainer" class="auth-container" style="user-select: none;">
    <div id="loginForm" class="auth-form">
      <h2>Login to JSON Chat</h2>
      <input type="email" id="loginEmail" placeholder="Email" />
      <div class="password-container">
        <input type="password" id="loginPassword" placeholder="Password" />
      </div>
      <div style="display:flex; align-items:center; gap:8px; margin-top:8px;">
        <input type="checkbox" id="loginPasswordToggle" style="margin:0; width:16px; height:16px;" />
        <label for="loginPasswordToggle" style="font-size:12px; color:var(--muted); cursor:pointer; user-select:none;">Show password</label>
      </div>
      <div id="loginError" class="error hidden"></div>
      <button id="loginBtn">Login</button>
      <a class="link" id="showRegister">Don't have an account? Register</a>
    </div>

    <div id="registerForm" class="auth-form hidden">
      <h2>Register for JSON Chat</h2>
      <input type="text" id="registerName" placeholder="Full Name" />
      <input type="email" id="registerEmail" placeholder="Email (required)" />
      <div class="password-container">
        <input type="password" id="registerPassword" placeholder="Password (min 6 chars)" />
      </div>
      <div style="display:flex; align-items:center; gap:8px; margin-top:8px;">
        <input type="checkbox" id="registerPasswordToggle" style="margin:0; width:16px; height:16px;" />
        <label for="registerPasswordToggle" style="font-size:12px; color:var(--muted); cursor:pointer; user-select:none;">Show password</label>
      </div>
      <div id="registerError" class="error hidden"></div>
      <button id="registerBtn">Register</button>
      <a class="link" id="showLogin">Already have an account? Login</a>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/client.js"></script>
</body>
</html>
